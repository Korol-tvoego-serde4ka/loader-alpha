# Minecraft Loader Alpha

Система лоадера для Minecraft с авторизацией по ключам, интеграцией с Discord и современным веб-интерфейсом управления.

## Особенности

- Авторизация по ключам
- Интеграция с Discord ботом (привязка/отвязка, автоматические роли)
- Система генерации временных ключей
- Инвайт-система для регистрации новых пользователей
- Администрирование через веб-интерфейс
- Автоматическая проверка времени действия ключей
- Смена пароля пользователем и администратором
- Раскрытие действий по клику на пользователя
- Экспорт таблиц (пользователи, ключи, инвайты)
- Современный UI с поддержкой тёмной темы

## Структура проекта

```
loader-alpha/
│
├── server/                  # Серверная часть (Ubuntu)
│   ├── website/             # Веб-сайт для управления ключами
│   │   └── static/downloads/  # Директория для размещения файлов лоадера
│   ├── discord_bot/         # Discord бот
│   ├── database/            # Скрипты и модели базы данных
│   └── requirements.txt     # Зависимости для сервера
│
├── client/                  # Клиентская часть (Windows)
│   ├── src/                 # Исходный код лоадера
│   ├── assets/              # Ресурсы (иконки и т.д.)
│   ├── build.bat            # Скрипт для сборки лоадера
│   └── requirements.txt     # Зависимости для клиента
│
└── docs/                    # Документация и инструкции
    ├── SETUP.md             # Инструкция по установке
    └── API.md               # Документация по API
```

## Установка

Подробные инструкции по установке и настройке см. в файле [docs/SETUP.md](docs/SETUP.md).

### Инициализация и миграция базы данных

1. Инициализация базы данных:
   ```bash
   cd server
   python run_init_db.py
   ```
   Это создаст необходимые таблицы, аккаунт администратора и начальный инвайт-код.

2. При обновлении системы может потребоваться миграция базы данных:
   ```bash
   cd server
   python run_migration.py
   ```
   Этот скрипт внесет необходимые изменения в структуру базы данных.

## Основной функционал

### Пользовательский веб-интерфейс
- Регистрация по инвайту
- Авторизация по JWT
- Просмотр и активация ключей
- Привязка и отвязка Discord-аккаунта
- Смена пароля (в профиле)
- Просмотр своих инвайтов и лимитов
- Экспорт таблиц в CSV
- Тёмная/светлая тема

### Администрирование
- Просмотр всех пользователей, ключей, инвайтов
- Бан/разбан пользователей
- Смена ролей (админ, саппорт, пользователь)
- Смена пароля любому пользователю
- Отвязка Discord-аккаунта любого пользователя
- Генерация ключей (на себя, на других, свободные)
- Массовые действия с ключами (отозвать, восстановить, удалить)
- Управление лимитами инвайтов
- Просмотр активности пользователей (IP, время входа)

### Discord-интеграция
- Привязка аккаунта через код
- Автоматическая выдача/снятие ролей в Discord
- Проверка и удаление ролей у пользователей с истёкшими ключами
- Команды бота:
  - `/code <код>` — привязка аккаунта
  - `/redeem <ключ>` — активация ключа
  - `/status` — статус подписки
  - `/genkey [продолжительность]` — генерация ключа (админ/саппорт)
  - `/ban <имя_пользователя>` — бан (админ/саппорт)
  - `/unban <имя_пользователя>` — разбан (админ/саппорт)
  - `/user <имя_пользователя>` — информация (админ/саппорт)

### Безопасность
- Все защищённые действия требуют JWT
- Критичные действия (бан, смена пароля, смена ролей) — только для админов
- Пароли хранятся в виде bcrypt-хеша
- Валидация данных на сервере и клиенте

## Использование

### Сервер (Ubuntu 20.04)

1. Установите зависимости:
   ```bash
   cd server
   pip install -r requirements.txt
   ```
2. Настройте базу данных:
   ```bash
   python database/init_db.py
   ```
3. Разместите собранный лоадер в директории для скачивания:
   ```bash
   mkdir -p website/static/downloads
   cp /путь/к/собранному/minecraft-loader-alpha.exe website/static/downloads/
   ```
4. Запустите веб-сервер:
   ```bash
   cd website
   python app.py
   ```
5. Запустите Discord бота:
   ```bash
   cd discord_bot
   python bot.py
   ```

### Клиент (Windows)

1. Соберите исполняемый файл:
   ```bash
   cd client
   build.bat
   ```
2. Запустите созданный файл `dist/minecraft-loader-alpha.exe`

## Лицензия

Лицензионная, все права правы, все лева - левы.